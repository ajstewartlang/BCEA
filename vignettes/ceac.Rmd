---
title: "Cost-effectiveness acceptability curve plots"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ceac}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
  
```{r, include = FALSE}
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.width = 6
)
```

```{r setup, results='hide', message=FALSE, warning=FALSE}
library(BCEA)
library(dplyr)
library(reshape2)
library(ggplot2)
library(purrr)
```

The intention of this vignette is to show how to plot different styles of cost-effectiveness acceptability curves using the BCEA package.

## Two interventions only

This is the simplest case, usually status-quo versus an alternative intervention.

```{r}
data("Vaccine")

he <- bcea(e, c)
# str(he)

ceac.plot(he)
```

The plot defaults to base R plotting. Type of plot can be set explicitly using the `graph` argument.

```{r}
ceac.plot(he, graph = "base")
ceac.plot(he, graph = "ggplot2")
# ceac.plot(he, graph = "plotly")
```

Other plotting arguments can be specified such as title, line colours and theme.

```{r}
ceac.plot(he,
          graph = "ggplot2",
          title = "my title",
          line = list(colors = "green"),
          theme = theme_dark())
```


## Multiple interventions

This situation is when there are more than two interventions to consider.
Incremental values can be obtained either alway against a fixed reference intervention, such as status-quo, or for all pair-wise comparisons.

### Against a fixed reference intervention

```{r}
data("Smoking")

he <- bcea(e, c, ref = 4)
# str(he)

ceac.plot(he)

ceac.plot(he,
          graph = "base",
          title = "my title",
          line = list(colors = "green"),
          pos = FALSE)

mypalette <- RColorBrewer::brewer.pal(3, "Accent")

ceac.plot(he,
          graph = "base",
          title = "my title",
          line = list(colors = mypalette),
          pos = FALSE)
```

### Pair-wise comparisons

First we must determine all combinations of paired interventions using the `multi.ce()` function.

```{r}
he <- multi.ce(he)
```

We can use the same plotting calls as before i.e. `ceac.plot()` and BCEA will deal with the pairwise situation appropriately.
Note that in this case the probabilities at a given willingness to pay sum to 1.

```{r}
ceac.plot(he, graph = "base")

ceac.plot(he,
          graph = "base",
          title = "my title",
          line = list(colors = "green"),
          pos = FALSE)

mypalette <- RColorBrewer::brewer.pal(4, "Dark2")

ceac.plot(he,
          graph = "base",
          title = "my title",
          line = list(colors = mypalette),
          pos = c(0,1))
```

```{r}
# rmarkdown::render(input = "vignettes/ceac.Rmd", output_format = "pdf_document", output_dir = "vignettes")
```